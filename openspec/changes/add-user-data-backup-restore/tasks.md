## 1. OpenSpec and Rule Lock
- [ ] 1.1 Confirm v1 rules `BR-001` to `BR-037` are represented in proposal/design/spec files.
- [ ] 1.2 Validate OpenSpec change with `openspec validate add-user-data-backup-restore --strict`.

## 2. Backend Contracts and Command Surface
- [ ] 2.1 Add `src-tauri/src/commands/backup.rs` and register commands in `src-tauri/src/commands/mod.rs`.
- [ ] 2.2 Define typed request/response contracts in Rust and generated frontend bindings:
  - [ ] `CreateBackupRequest` with scope (`full` or `lightweight`) and user-selected output path.
  - [ ] `CreateBackupReport` with counts, warnings, output path, and duration.
  - [ ] `PreflightRestoreRequest` and `PreflightRestoreReport` (with current-vs-backup counts, backup identity metadata, concise summary, and optional detailed findings).
  - [ ] `ApplyRestoreRequest` and `ApplyRestoreReport`.
  - [ ] `BackupProgress` event payload with `phase`, `current`, `total`, `estimated_seconds_remaining`.
  - [ ] `EstimateSizeRequest` and `EstimateSizeReport`.
  - [ ] `GetBackupOperationStatusReport` (or equivalent) to reattach UI after settings reopen/background operation.
  - [ ] `StartupRestoreReconciliationReport` payload for user-facing post-crash outcome summary.
- [ ] 2.3 Add an app-level operation mutex so only one backup/restore runs concurrently (`BR-016`).
- [ ] 2.4 Add operation cancel token plumbing for export/restore flows (`BR-020`).
- [ ] 2.5 Add persistent restore-in-progress marker state for crash reconciliation (`BR-021`).
- [ ] 2.6 Add restore quiesce-mode state/plumbing to block new transcription/history writes during apply-restore (`BR-034`).
- [ ] 2.7 Add soft resource-threshold settings model (read/write/persist) for power-user overrides (`BR-035`).
- [ ] 2.8 Add safety-backup inventory + retention metadata model (path, timestamp, scope, size, retention prune state).
- [ ] 2.9 Add operation lifecycle state so backup/restore continues when settings window closes and can be queried/reported by tray/notification surfaces.
- [ ] 2.10 Ensure pre-restore safety backup runs as an internal restore phase and does not reacquire the top-level backup/restore mutex (avoid self-deadlock/busy false positives).
- [ ] 2.11 Add typed `restore_in_progress` blocked-action response/event contract so hotkey/tray/UI entry points can show consistent status and offer `Open restore status`.

## 3. Export Pipeline Implementation
- [ ] 3.1 Implement archive workspace builder that writes exact layout required by `BR-002` (including `settings/settings.json`).
- [ ] 3.2 Implement estimated archive size calculation and preview (`BR-029`).
- [ ] 3.3 Implement history logical export (`BR-005`):
  - [ ] query `transcription_history` rows into `history/history.jsonl`.
  - [ ] query `user_stats` into `history/user_stats.json`.
  - [ ] do not copy `history.db` into backup artifact.
- [ ] 3.4 Implement dictionary export from settings payload into `dictionary/dictionary.json`.
- [ ] 3.5 Implement selective settings export into `settings/settings.json` (`BR-026`):
  - [ ] include user-configurable preferences.
  - [ ] exclude `post_process_api_keys` (sensitive).
  - [ ] exclude `selected_microphone`, `clamshell_microphone`, `selected_output_device`, `selected_model` (device-specific).
  - [ ] exclude `debug_mode` (runtime state).
  - [ ] include `settings_payload_version`.
- [ ] 3.6 Implement scope handling (`BR-006`):
  - [ ] full scope copies available referenced recordings.
  - [ ] lightweight scope omits `recordings/` but still includes history, dictionary, and settings payloads.
- [ ] 3.7 Implement missing-recording warning behavior for full backups (`BR-007`).
- [ ] 3.8 Implement cross-platform path normalization: forward-slash separators, NFC Unicode, invalid character validation (`BR-030`).
- [ ] 3.9 Implement manifest generation with required fields including `platform` and `estimated_size_bytes` (`BR-003`).
- [ ] 3.10 Implement SHA-256 checksum file generation for all payload files (`BR-004`).
- [ ] 3.11 Package workspace into `.codictatebackup` ZIP and write output atomically (`BR-001`).
- [ ] 3.12 Return `CreateBackupReport` with counts and warnings (`BR-015`).
- [ ] 3.13 Add export storage-capacity precheck for both temp workspace and destination (`BR-019`):
  - [ ] detect destination filesystem single-file size limits (for example FAT32 4 GiB) before export starts.
  - [ ] return actionable failure guidance so frontend can offer pick-another-location or switch-to-lightweight choices.
- [ ] 3.14 Add export cancellation checkpoints and temp/output cleanup behavior (`BR-020`).
- [ ] 3.15 Emit progress events at each major step with ETA (`BR-028`).
- [ ] 3.16 Add export destination filename guardrails:
  - [ ] prefill save dialog with `codictate-backup-YYYY-MM-DD_HH-mm.codictatebackup`.
  - [ ] auto-append `.codictatebackup` when omitted.
  - [ ] require explicit overwrite confirmation for existing destination files.

## 4. Restore Preflight Implementation
- [ ] 4.1 Validate archive entry safety from archive metadata before file-content extraction (reject traversal, absolute path, symlink/hardlink entries) (`BR-018`).
- [ ] 4.2 Implement archive unpack to temp workspace only after `4.1` safety checks pass.
- [ ] 4.3 Validate required files exist including `settings/settings.json` (`BR-002`).
- [ ] 4.4 Parse and validate manifest fields including `platform` (`BR-003`).
- [ ] 4.5 Verify checksums before any write (`BR-004`, `BR-008`).
- [ ] 4.6 Enforce compatibility policy `current major + previous major` (`BR-009`).
- [ ] 4.7 Normalize extracted filenames to NFC Unicode and validate cross-platform filename safety with issue classification (`BR-030`).
- [ ] 4.8 Add restore storage-capacity precheck including safety backup size (`BR-019`):
  - [ ] include pruneable automatic safety backups in low-space estimation/recovery path before fallback prompts.
- [ ] 4.9 Build and return `PreflightRestoreReport` with:
  - [ ] compatibility result
  - [ ] current-vs-backup counts side-by-side
  - [ ] backup identity metadata (created timestamp, app version, platform, includes-recordings, archive size)
  - [ ] payload counts
  - [ ] concise user-facing summary (plain language; not overwhelming)
  - [ ] blocking findings list (must abort)
  - [ ] recoverable findings list (can continue with user confirmation)
  - [ ] optional detailed findings payload for explicit `View details` UX
  - [ ] warning list (including missing recordings declared by manifest)
- [ ] 4.10 Add preflight decision contract: when recoverable-only findings exist, frontend must send explicit `continue_partial_restore` confirmation (`BR-033`).
- [ ] 4.11 Enforce two-tier resource limits during preflight (`BR-035`):
  - [ ] non-overridable hard security bounds (compression ratio + absolute parser ceilings).
  - [ ] generous soft operational thresholds (entry count/size/rows) that trigger warning flow.
  - [ ] warning decision actions: continue once, update soft limits and continue, or cancel.
- [ ] 4.12 Include integrity-scope disclosure in preflight result payload/UI model (`BR-036`).

## 5. Restore Apply Implementation (Replace-Only)
- [ ] 5.1 Auto-create pre-restore safety backup using full-first policy (`BR-024`):
  - [ ] attempt full safety `.codictatebackup` first.
  - [ ] run safety backup as an internal restore phase without reacquiring top-level operation lock.
  - [ ] if full fails from low space, prune old automatic safety backups per policy and retry full once before offering fallback choices.
  - [ ] if full fails, present explicit choices: retry full, continue lightweight fallback, cancel.
  - [ ] never silently downgrade from full to lightweight.
  - [ ] log safety backup path and scope (`full` or `lightweight`).
  - [ ] include safety backup metadata in result payload (path, created_at, scope, size_bytes) for UI discoverability.
  - [ ] abort restore unless selected safety backup mode succeeds.
- [ ] 5.2 Implement component migration pipeline (`BR-010`) for history payload, dictionary payload, and settings payload versions.
- [ ] 5.3 Create staging restore area with fresh DB initialized through current migrations.
- [ ] 5.4 Import migrated history rows into staging DB.
- [ ] 5.5 Recompute `user_stats` from imported history rows (`BR-025`):
  - [ ] recalculate `total_words`, `total_duration_ms`, `total_transcriptions`, `transcription_dates`, `total_filler_words_removed`.
- [ ] 5.6 Import dictionary payload into staged settings payload.
- [ ] 5.7 Merge settings selectively into staged settings, applying forward-compatible defaults for new/missing fields (`BR-027`):
  - [ ] fields present in backup → restore.
  - [ ] fields missing from backup but in current schema → keep defaults.
  - [ ] fields in backup but removed from schema → silently ignore.
- [ ] 5.8 Copy recordings from archive when present.
- [ ] 5.9 Implement deterministic conflict resolution (`BR-022`):
  - [ ] duplicate history IDs resolved via deterministic rekey (preserve valid rows; backup IDs non-authoritative).
  - [ ] duplicate recording filenames resolved by suffix rename (e.g., `_1`, `_2`).
  - [ ] malformed history rows are skipped with recoverable warnings.
  - [ ] oversized JSONL lines/rows are skipped with recoverable warnings using bounded parser (`BR-035`).
  - [ ] invalid optional recording filenames are sanitized/remapped when safe, otherwise skipped with recoverable warnings.
  - [ ] references remapped to match resolved filenames.
- [ ] 5.10 Run staging validation:
  - [ ] SQLite integrity check passes.
  - [ ] payload counts match import counts.
- [ ] 5.11 Execute replace-only swap (`BR-011`, `BR-012`):
  - [ ] move active restore-managed data to rollback location.
  - [ ] move staged data into active app data paths.
- [ ] 5.12 Implement rollback path on any failure (`BR-013`).
- [ ] 5.13 Emit state refresh events (history/settings) after successful restore.
- [ ] 5.14 Return `ApplyRestoreReport` with restored counts, warnings, and failures (`BR-015`).
- [ ] 5.15 Add restore cancellation checkpoints and cleanup behavior (`BR-020`).
- [ ] 5.16 Implement startup reconciliation using restore-in-progress marker (`BR-021`).
- [ ] 5.17 Emit progress events at each major step with ETA (`BR-028`).
- [ ] 5.18 Ensure restore quiesce mode is entered before apply-restore and always exited on success/failure/rollback (`BR-034`).
- [ ] 5.19 Implement automatic safety-backup retention policy with explicit defaults:
  - [ ] keep newest 3 automatic safety backups.
  - [ ] never auto-prune explicitly saved safety backups.
  - [ ] prune old automatic backups before full-safety-backup fallback prompts when low-space is detected.
- [ ] 5.20 Implement post-restore safety-backup disposition flow:
  - [ ] support user actions `Save safety backup` and `Discard safety backup`.
  - [ ] require explicit confirmation before discard deletion.
  - [ ] persist saved/discarded status in safety-backup inventory metadata.
- [ ] 5.21 Emit explicit reconciliation outcome event/report at startup so frontend can display post-interruption summary.

## 6. Missing Audio Runtime Behavior
- [ ] 6.1 Update audio lookup/playback flow to detect missing recording file and return typed error instead of crash (`BR-014`).
- [ ] 6.2 Add frontend handling for missing-audio error with clear user message (`BR-014`).
- [ ] 6.3 Ensure lightweight backup restores remain usable for history text even without recordings.

## 7. Frontend UX and Guardrails
- [ ] 7.1 Add backup UI controls in Settings with two scope options only (`full`, `lightweight`) (`BR-006`):
  - [ ] default selection is `full`.
  - [ ] `full` is labeled as comprehensive backup option.
  - [ ] `lightweight` requires explicit user choice and clearly states recordings are excluded while history/dictionary/settings remain included.
- [ ] 7.2 Add estimated archive size preview before export (`BR-029`).
- [ ] 7.3 Add explicit unencrypted notice in export flow (`BR-017`).
- [ ] 7.4 Add progress bar with ETA for export and restore operations (`BR-028`).
- [ ] 7.5 Add restore flow with two steps:
  - [ ] Step A: preflight summary view from `PreflightRestoreReport` with current-vs-backup counts, backup identity metadata, and concise blocking/recoverable summary.
  - [ ] Step A includes optional `View details` drill-in for per-item findings.
  - [ ] Step B: replace-only confirmation dialog with `Will restore` and `Will not restore` sections, clearly warning current data will be replaced.
  - [ ] Step B explicitly lists excluded settings (API keys, selected devices, selected model).
  - [ ] Step B explicitly states missing-audio consequences when recordings are absent.
- [ ] 7.6 Add recoverable-findings decision UI:
  - [ ] show explicit choices `Continue partial restore` and `Cancel`.
  - [ ] only continue when user explicitly confirms partial restore (`BR-033`).
- [ ] 7.7 Show compatibility gate errors and remediation messages for unsupported versions (`BR-009`).
- [ ] 7.8 Show pragmatic success/failure summaries using structured reports (`BR-015`):
  - [ ] default summary is short and confidence-building (`backup is ready` / `restore completed`).
  - [ ] include only key counts/impact in default view.
  - [ ] provide `View details` for full warning/file-level diagnostics.
- [ ] 7.9 Add insufficient disk space warning in export and restore flows (`BR-019`).
- [ ] 7.10 Show integrity-scope disclosure text in restore preflight UI (checksums detect corruption, not trusted-origin authenticity) (`BR-036`).
- [ ] 7.11 Add soft-threshold warning UI for power users (`BR-035`):
  - [ ] show warning with observed vs configured limits.
  - [ ] provide choices: continue once, update limits and continue, cancel.
  - [ ] expose soft-threshold settings editor for advanced users.
- [ ] 7.12 Add full-first safety-backup fallback UI (`BR-024`):
  - [ ] when full safety backup fails, show choices: retry full, continue lightweight fallback, cancel.
  - [ ] show reduced rollback fidelity warning when lightweight fallback is selected.
- [ ] 7.13 Add cancellation UX states (`BR-020`):
  - [ ] show visible cancel action during cancellable phases for export/restore.
  - [ ] show cancel-in-progress cleanup state after user requests cancel.
  - [ ] show explicit non-cancellable commit-phase messaging when cancel is temporarily unavailable.
- [ ] 7.14 Add destination filesystem-limit error UX for export:
  - [ ] show actionable message when destination max-file-size is below estimated archive size.
  - [ ] provide explicit actions: choose another destination or switch to lightweight.
- [ ] 7.15 Add safety-backup management UI:
  - [ ] show latest safety backup metadata (path, timestamp, scope, size) after restore pre-check/create.
  - [ ] add actions: reveal location, copy path, delete selected backup.
  - [ ] after restore completion, prompt user to `Save safety backup` or `Discard safety backup` (default to `Save`).
  - [ ] show retention policy disclosure in backup/restore settings.
- [ ] 7.16 Add background-operation UX:
  - [ ] keep backup/restore running if settings window closes/minimizes.
  - [ ] reattach in-progress UI when settings is reopened.
  - [ ] show tray or desktop completion/failure notification.
  - [ ] if tray icon is hidden, provide desktop notification with action to open live status.
  - [ ] on app quit attempt during cancellable phase, require explicit `Keep running in background` or `Cancel and quit`.
  - [ ] on app quit attempt during non-cancellable commit/rollback, require explicit `Keep running in background` or `Quit when safe` (no cancel-and-quit in that phase).
- [ ] 7.17 Add startup reconciliation outcome UX:
  - [ ] show post-crash restore reconciliation summary banner/dialog with outcome, timestamp, and next-step guidance.
- [ ] 7.18 Add accessibility guardrails for backup/restore UI:
  - [ ] keyboard-only operation for all dialogs and actions.
  - [ ] focus trap/restore and safe default focus in destructive dialogs.
  - [ ] screen-reader announcements for progress/warnings/failure/completion.
  - [ ] non-color-only severity cues and accessible contrast in warning/error states.
- [ ] 7.19 Add export destination UX guardrails:
  - [ ] prefill save dialog with default `codictate-backup-YYYY-MM-DD_HH-mm.codictatebackup`.
  - [ ] auto-append `.codictatebackup` when omitted.
  - [ ] show explicit overwrite confirmation for existing files.
- [ ] 7.20 Add quiesce blocked-action UX across all entry points:
  - [ ] hotkey/tray/main UI transcription attempts show consistent `restore in progress` message.
  - [ ] message includes action to open live restore status.

## 8. Permissions and Capabilities
- [ ] 8.1 Configure Tauri capabilities for backup/restore:
  - [ ] `dialog:allow-save` — file-save dialog for export destination.
  - [ ] `dialog:allow-open` — file-open dialog for restore source.
  - [ ] `fs:allow-read` — scoped to app data dir + user-selected archive paths.
  - [ ] `fs:allow-write` — scoped to app data dir + user-selected archive paths.
  - [ ] `fs:allow-mkdir` — for temp workspace creation.
  - [ ] `fs:allow-remove` — for temp workspace cleanup.
- [ ] 8.2 Ensure restore/export only operate on user-selected files plus app data paths (`BR-023`).

## 9. Structured Logging (`BR-031`)
- [ ] 9.1 Add `info!` logs at every major export milestone (start, snapshot, scan, write, package, complete with counts/duration).
- [ ] 9.2 Add `info!`/`error!` logs at every major restore milestone (preflight, safety backup, migration, staging, swap, rollback, reconciliation).
- [ ] 9.3 Add `warn!` logs for all recoverable warnings (missing recordings, skipped malformed rows, skipped invalid optional filenames, low space).
- [ ] 9.4 Add frontend `logInfo`/`logError` calls with target `fe-backup` for all user-initiated backup/restore actions.
- [ ] 9.5 Add `debug!` logs for intermediate steps using metadata only (counts/indices), never raw row payload content (`BR-037`).
- [ ] 9.6 Add centralized redaction guard/helper and apply it to backend/frontend backup logs (`BR-037`).

## 10. Internationalization (`BR-032`)
- [ ] 10.1 Add all backup/restore UI strings to `src/i18n/locales/en/translation.json` under `settings.backup` namespace.
- [ ] 10.2 Use `t()` for all user-facing text in backup/restore components.
- [ ] 10.3 Include: scope labels, unencrypted notice, preflight summary, replace-only warning, progress messages, missing-audio message, error messages, success messages, estimated size text, current-vs-backup comparison text.

## 11. Test Matrix
- [ ] 11.1 Unit tests for manifest serializer/deserializer and checksum generation (`BR-003`, `BR-004`).
- [ ] 11.2 Unit tests for compatibility gate rules (`BR-009`).
- [ ] 11.3 Unit tests for migration dispatcher and missing migration failure (`BR-010`).
- [ ] 11.4 Unit tests for selective settings export/import and forward-compatible merge (`BR-026`, `BR-027`).
- [ ] 11.5 Unit tests for user stats recomputation from history rows (`BR-025`).
- [ ] 11.6 Unit tests for cross-platform filename normalization and invalid character sanitization (`BR-030`).
- [ ] 11.7 Integration test: full backup round-trip with recordings (`BR-001`, `BR-006`, `BR-012`).
- [ ] 11.8 Integration test: lightweight backup round-trip without recordings restores history, dictionary, and settings (`BR-006`, `BR-014`, `BR-026`, `BR-027`).
- [ ] 11.9 Integration test: preflight rejects corrupted archive (checksum mismatch) (`BR-004`, `BR-008`).
- [ ] 11.10 Integration test: preflight rejects too-old and forward-incompatible versions (`BR-009`).
- [ ] 11.11 Integration test: restore failure triggers rollback and leaves active data unchanged (`BR-013`).
- [ ] 11.12 Integration test: missing recordings in full export produce warnings but export succeeds (`BR-007`).
- [ ] 11.13 Integration test: pre-restore full safety backup is attempted before overwrite (`BR-024`).
- [ ] 11.14 Integration test: settings selective merge restores preferences but not API keys (`BR-026`, `BR-027`).
- [ ] 11.15 Integration test: backup from older app version restores with defaults for new fields (`BR-027`).
- [ ] 11.16 Integration test: progress events are emitted during export and restore (`BR-028`).
- [ ] 11.17 Integration test: estimated size preview matches actual archive size within tolerance (`BR-029`).
- [ ] 11.18 Frontend tests for unencrypted notice, preflight summary with current-vs-backup counts, replace-only warning, progress bar, and missing-audio message.
- [ ] 11.19 Integration test: archive path traversal entry is rejected (`BR-018`).
- [ ] 11.20 Integration test: archive symlink/hardlink entry is rejected (`BR-018`).
- [ ] 11.21 Integration test: low-disk export and restore prechecks fail safely (`BR-019`).
- [ ] 11.22 Integration test: cancel export and restore clean up temp artifacts and keep active data intact (`BR-020`).
- [ ] 11.23 Integration test: crash/interruption during restore reconciles safely on next startup (`BR-021`).
- [ ] 11.24 Integration test: duplicate ID/filename payload imports resolve with deterministic rekey and suffix rename while preserving valid rows (`BR-022`).
- [ ] 11.25 Integration test: concurrent backup/restore request is rejected while operation lock is held (`BR-016`).
- [ ] 11.26 Integration test: out-of-scope path operations are rejected (`BR-023`).
- [ ] 11.27 Integration test: cross-platform backup created on macOS restores correctly on Linux (`BR-030`).
- [ ] 11.28 Integration test: preflight recoverable-only findings require explicit user confirmation to continue partial restore (`BR-033`).
- [ ] 11.29 Integration test: user cancel on recoverable preflight findings aborts restore with active data unchanged (`BR-033`).
- [ ] 11.30 Integration test: restore quiesce mode blocks new writes during apply-restore and is released after completion (`BR-034`).
- [ ] 11.31 Integration test: restore rejects archive exceeding hard security bounds (for example compression-ratio abuse) as blocking (`BR-035`).
- [ ] 11.32 Integration test: soft-threshold exceedance triggers warning + explicit choice flow (`BR-035`).
- [ ] 11.33 Integration test: user can continue once after soft-threshold warning and restore completes (`BR-035`).
- [ ] 11.34 Integration test: user updates soft thresholds and restore re-evaluates using new values (`BR-035`).
- [ ] 11.35 Integration test: oversized JSONL lines are handled with bounded parser and skipped as recoverable warnings (`BR-035`).
- [ ] 11.36 Frontend test: preflight UI shows integrity-scope disclosure text (corruption-detection only) (`BR-036`).
- [ ] 11.37 Unit/integration test: backup/restore logs never contain transcript text, prompt text, API keys, or raw payload bodies (`BR-037`).
- [ ] 11.38 Integration test: full safety backup failure prompts fallback choice and respects retry/lightweight/cancel behavior (`BR-024`).
- [ ] 11.39 Frontend test: backup export defaults to `full` and lightweight copy clearly states excluded recordings and included text/settings.
- [ ] 11.40 Integration test: export precheck blocks when destination filesystem max-file-size is below estimate and returns actionable choices.
- [ ] 11.41 Frontend test: cancellation UX shows cancel action in cancellable phases, cancel-in-progress state, and commit-phase non-cancellable messaging.
- [ ] 11.42 Integration/frontend test: startup reconciliation outcome is surfaced to user after interrupted restore.
- [ ] 11.43 Frontend test: restore confirmation includes `Will restore` and `Will not restore` sections with explicit exclusion list.
- [ ] 11.44 Integration/frontend test: safety-backup metadata is shown, management actions work, save/discard actions work, and retention pruning preserves newest automatic backups while keeping explicitly saved backups.
- [ ] 11.45 Integration/frontend test: backup/restore continues when settings window closes and reattaches progress when reopened.
- [ ] 11.46 Integration/frontend test: app-quit attempt during active operation is phase-aware (cancellable phase allows cancel-and-quit; commit/rollback phase offers quit-when-safe only).
- [ ] 11.47 Accessibility test: backup/restore dialogs and progress flows are keyboard operable with correct focus management.
- [ ] 11.48 Accessibility test: screen readers receive progress/error announcements and warning/error severity is not color-only.
- [ ] 11.49 Integration test: pre-restore safety backup runs as internal restore phase and does not deadlock/reject itself as busy.
- [ ] 11.50 Frontend test: preflight and completion summaries are concise by default and show detailed diagnostics only via explicit `View details`.
- [ ] 11.51 Frontend test: restore confirmation shows backup identity metadata (created time, source app version, source platform, includes recordings, archive size).
- [ ] 11.52 Frontend/integration test: save dialog pre-fills Codictate default filename, auto-appends `.codictatebackup`, and requires overwrite confirmation.
- [ ] 11.53 Frontend/integration test: when tray icon is disabled, background operation status/completion is surfaced via desktop notification with open-status action.
- [ ] 11.54 Integration/frontend test: blocked transcription/history actions during restore quiesce show consistent `restore in progress` messaging with open-status action.

## 12. Documentation
- [ ] 12.1 Create `doc/backup-restore.md` with:
  - [ ] Feature overview and user guide with full and lightweight examples.
  - [ ] Clarify default export scope is `full`, and lightweight is an explicit choice with no recordings but still includes history/dictionary/settings.
  - [ ] Document export filename defaults and extension behavior (`codictate-backup-YYYY-MM-DD_HH-mm.codictatebackup`, auto-append, overwrite confirmation).
  - [ ] Architecture Decision Record (ADR): why JSONL over SQLite copy, why ZIP over tar.gz, why replace-only over merge.
  - [ ] Error catalog documenting all user-facing error conditions and messages.
  - [ ] Archive format spec, compatibility window, and migration guidance for unsupported versions.
  - [ ] Integrity scope note: checksums provide corruption detection only in v1 (no trusted-origin authenticity).
  - [ ] Restore resource limit table and operator guidance for limit failures.
  - [ ] Destination filesystem limit guidance (for example FAT32/exFAT constraints) and remediation choices.
  - [ ] Document soft-threshold override/update UX and hard-bound non-overridable safety guarantees.
  - [ ] Document cancellation behavior, non-cancellable commit/rollback phase messaging, phase-aware quit options, and background continuation behavior.
  - [ ] Document safety-backup discoverability, save/discard choice, management actions, and automatic retention policy (including explicitly saved backup behavior).
  - [ ] Document concise default summaries and optional `View details` diagnostics for preflight/restore outcomes.
  - [ ] Document startup reconciliation outcome messaging after interrupted restore.
  - [ ] Document accessibility expectations for backup/restore dialogs and progress flows.
  - [ ] Note that v1 backups are unencrypted and suggest external encryption options.
- [ ] 12.2 Update `doc/prodRelease.md` with backup compatibility section:
  - [ ] Pre-release checklist item: verify backup format changes don't break existing user backups.
  - [ ] Consider if schema migrations need updating.
  - [ ] Consider if settings backup inclusion/exclusion lists need updating for new fields.
